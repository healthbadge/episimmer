import sys
sys.path.insert(1, '../src/')
import ReadFile
import random
from operator import itemgetter

class Agent_MC():
	def __init__(self, world_obj):
		self.world_obj=world_obj
		self.agent_scores={}
		self.init_scores()

	def init_scores(self):
		agents_obj=ReadFile.ReadAgents(self.world_obj.agents_filename,self.world_obj.config_obj)
		for agent_index in agents_obj.agents.keys():
			self.agent_scores[agent_index]=0

	def one_run(self):
		_,agents_obj,_=self.world_obj.one_world()
		for agent in agents_obj.agents.values():
			if agent.state=='Recovered':
				self.agent_scores[agent.index]+=1

	def do_MC(self,num_runs):
		for i in range(num_runs):
			if i%100==0:
				print(i)
			self.one_run()

	def get_vulnerable(self,n):
		res_max = dict(sorted(self.agent_scores.items(), key = itemgetter(1))[-n:])
		res_min = dict(sorted(self.agent_scores.items(), key = itemgetter(1))[:n])
		return res_max.keys(),res_min.keys()
